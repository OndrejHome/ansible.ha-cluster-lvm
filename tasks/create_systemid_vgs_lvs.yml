---
- name: Use extra options when creating VG on EL 8.5+
  set_fact:
    extra_vg_options: "--setautoactivation n"
  when:
    - ansible_distribution_version is version('8.5', '>=')

- name: create systemid VG
  lvg:
    vg: "{{ item.name }}"
    pvs: "{{ item.pvs }}"
    vg_options: "{{ extra_vg_options | default(omit) }}"
  with_items:
    - "{{ systemid_vgs }}"
  run_once: True

- name: create LVs on systemid VG
  lvol:
    vg: "{{ item.0.name }}"
    lv: "{{ item.1.name }}"
    size: "{{ item.1.size }}"
  with_subelements:
    - "{{ systemid_vgs }}"
    - lvs
  run_once: True
